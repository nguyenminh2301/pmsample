VI = {
        "title": "Prognostic Research Sample Size Tool",
        "sidebar_title": "Cáº¥u hÃ¬nh",
        "language": "NgÃ´n ngá»¯ / Language",
        "mode": "Chá»n PhÆ°Æ¡ng phÃ¡p",
        "mode_riley": "PhÆ°Æ¡ng phÃ¡p 1: Riley et al. (CÃ´ng thá»©c)",
        "mode_bayes": "PhÆ°Æ¡ng phÃ¡p 2: Bayesian Assurance (MÃ´ phá»ng)",
        "mode_single": "Ká»‹ch báº£n Ä‘Æ¡n (Single)",
        "mode_batch": "PhÃ¢n tÃ­ch Ä‘á»™ nháº¡y (Nhiá»u giÃ¡ trá»‹)",
        "method1_tab": "PhÆ°Æ¡ng phÃ¡p 1 (Riley)",
        "method2_tab": "PhÆ°Æ¡ng phÃ¡p 2 (Bayesian)",
        "nav_title": "Äiá»u hÆ°á»›ng",
        "nav_readme": "TÃ i liá»‡u Chi tiáº¿t (README)",
        "nav_intro": "Giá»›i thiá»‡u & CÃ´ng thá»©c",
        "nav_calc": "CÃ´ng cá»¥ tÃ­nh toÃ¡n",
        "intro_heading": "Giá»›i thiá»‡u",
        "intro_text": "á»¨ng dá»¥ng há»— trá»£ Æ°á»›c tÃ­nh cá»¡ máº«u tá»‘i thiá»ƒu cho mÃ´ hÃ¬nh dá»± bÃ¡o lÃ¢m sÃ ng (biáº¿n nhá»‹ phÃ¢n).",
        "formula_heading": "CÆ¡ sá»Ÿ ToÃ¡n há»c (PhÆ°Æ¡ng phÃ¡p 1)",
        "formula_intro": "PhÆ°Æ¡ng phÃ¡p 1 dÃ¹ng cÃ´ng thá»©c giáº£i tÃ­ch (Riley), PhÆ°Æ¡ng phÃ¡p 2 dÃ¹ng mÃ´ phá»ng Bayesian MCMC.",
        "sens_guide_title": "ğŸ’¡ HÆ°á»›ng dáº«n nháº­p PhÃ¢n tÃ­ch Äá»™ nháº¡y",
        "sens_guide_text": """
        - **Khoáº£ng giÃ¡ trá»‹**: Nháº­p `min-max` (VD: `0.05-0.10`).
        - **Danh sÃ¡ch giÃ¡ trá»‹**: Nháº­p dáº¥u pháº©y (VD: `0.05, 0.10, 0.15`).
        """,
        "detail_view": "Xem chi tiáº¿t",
        "footer_refs": "TÃ i liá»‡u tham kháº£o: Riley et al. (2018, 2020), BayesAssurance.",
        "calc_btn": "TÃ­nh toÃ¡n",
        "results": "Káº¿t quáº£",
        "sanity": "Kiá»ƒm tra nhanh (EPV)",
        "download_csv": "Táº£i xuá»‘ng CSV",
        "download_report": "Táº£i BÃ¡o cÃ¡o Äáº§y Ä‘á»§",
        "error_p": "Tá»· lá»‡ pháº£i tá»« 0 Ä‘áº¿n 1.",
        "error_auc": "AUC pháº£i tá»« 0.5 Ä‘áº¿n 1.",
        "error_parse": "Lá»—i nháº­p liá»‡u.",
        
        # Riley specific
        "riley_inputs": "Tham sá»‘ Ä‘áº§u vÃ o (Riley)",
        "prevalence": "Tá»· lá»‡ biáº¿n cá»‘ (Prevalence)",
        "prevalence_help": "Tá»· lá»‡ ngÆ°á»i cÃ³ biáº¿n cá»‘ (0 < p < 1).",
        "parameters": "Sá»‘ tham sá»‘ dá»± bÃ¡o (df)",
        "parameters_help": "Tá»•ng báº­c tá»± do cá»§a cÃ¡c biáº¿n (trá»« intercept).",
        "shrinkage": "Há»‡ sá»‘ co trÆ°á»£t (Shrinkage)",
        "shrinkage_help": "Há»‡ sá»‘ S mong muá»‘n (máº·c Ä‘á»‹nh 0.9).",
        "perf_measure": "Hiá»‡u nÄƒng dá»± kiáº¿n",
        "perf_auc": "AUC (C-statistic)",
        "perf_r2": "Cox-Snell R-squared",
        "perf_cons": "Tháº­n trá»ng (Conservative)",
        
        # Bayesian specific
        "bayes_inputs": "CÃ i Ä‘áº·t MÃ´ phá»ng (Bayesian Assurance)",
        "dgm_settings": "CÆ¡ cháº¿ Sinh Dá»¯ liá»‡u (DGM)",
        "sim_settings": "CÃ i Ä‘áº·t MÃ´ phá»ng & MCMC",
        "eval_settings": "TiÃªu chuáº©n ÄÃ¡nh giÃ¡",
        "n_candidates": "CÃ¡c má»©c Cá»¡ máº«u thá»­ nghiá»‡m (cÃ¡ch nhau bá»Ÿi dáº¥u pháº©y)",
        "n_candidates_help": "Danh sÃ¡ch N muá»‘n kiá»ƒm tra, VD: 500, 1000, 1500.",
        "correlation": "Há»‡ sá»‘ tÆ°Æ¡ng quan (rho)",
        "n_sims": "Sá»‘ láº§n mÃ´ phá»ng cho má»—i N",
        "assurance_threshold": "NgÆ°á»¡ng Assurance (XÃ¡c suáº¥t Ä‘áº¡t yÃªu cáº§u)",
        "run_simulation": "Cháº¡y MÃ´ phá»ng",
        "simulation_running": "Äang cháº¡y mÃ´ phá»ng... Vui lÃ²ng Ä‘á»£i.",
        "assurance_result": "PhÃ¢n tÃ­ch Assurance",

        # Method 6 (Dev Sim)
        "mode_dev_sim": "PhÆ°Æ¡ng phÃ¡p 6: MÃ´ phá»ng PhÃ¡t triá»ƒn (Freq)",
        "method6_tab": "PP 6 (MÃ´ phá»ng)",
        "dev_sim_intro": "TÃ­nh cá»¡ máº«u phÃ¡t triá»ƒn mÃ´ hÃ¬nh dá»±a trÃªn mÃ´ phá»ng (theo phÆ°Æ¡ng phÃ¡p `samplesizedev`).",
        "dev_mode_simple": "Cháº¿ Ä‘á»™ A: ÄÆ¡n giáº£n (theo AUC)",
        "dev_mode_custom": "Cháº¿ Ä‘á»™ B: DGM TÃ¹y chá»‰nh",
        "target_auc": "AUC Má»¥c tiÃªu (C-statistic trung bÃ¬nh)",
        "target_auc_help": "Thuáº­t toÃ¡n sáº½ tá»± tÃ¬m há»‡ sá»‘ Beta Ä‘á»ƒ Ä‘áº¡t AUC nÃ y.",
        "criteria_settings": "TiÃªu chÃ­ Äáº¡t (Pass/Fail)",
        "crit_slope_mean": "Calibration Slope TB >= 0.9",
        "crit_slope_ci": "Pr(0.9 <= Slope <= 1.1) >= 80%",
        "crit_auc": "AUC TB >= Má»¥c tiÃªu",
        "audit_trail": "RNG Audit Trail (JSON)",
        "future_methods": "Sáº¯p ra máº¯t...",

        # Quick Methods
        "method_quick_tab": "A. Nhanh / CÆ¡ báº£n",
        "quick_mode_epv": "A1: Quy táº¯c EPV / EPP (Kinh nghiá»‡m)",
        "quick_mode_risk": "A2: Æ¯á»›c lÆ°á»£ng Tá»· lá»‡ ná»n (Äá»™ rá»™ng CI)",
        "target_epv": "Sá»‘ biáº¿n cá»‘ trÃªn tham sá»‘ má»¥c tiÃªu (EPP)",
        "target_epv_help": "GiÃ¡ trá»‹ thÆ°á»ng dÃ¹ng: 10, 15, 20. EPP tá»‘t hÆ¡n EPV.",
        "epv_warning_title": "âš ï¸ Cáº£nh bÃ¡o Quan trá»ng",
        "epv_warning_text": "EPV/EPP chá»‰ lÃ  quy táº¯c kinh nghiá»‡m thÃ´. NÃ³ KHÃ”NG Ä‘áº£m báº£o Ä‘á»™ chÃ­nh xÃ¡c, phÃ¢n biá»‡t hay ngÄƒn ngá»«a overfitting. Ráº¥t nháº¡y cáº£m vá»›i viá»‡c chá»n biáº¿n vÃ  Ä‘a cá»™ng tuyáº¿n.",
        "ci_level": "Äá»™ tin cáº­y (Confidence Level)",
        "ci_half_width": "BÃ¡n kÃ­nh CI mong muá»‘n (Sai sá»‘ biÃªn)",
        "ci_method": "PhÆ°Æ¡ng phÃ¡p CI",
        "ci_method_wilson": "Wilson Score (KhuyÃªn dÃ¹ng)",
        "ci_method_wald": "Wald (ÄÆ¡n giáº£n)",
        "ci_method_cp": "Clopper-Pearson (Tháº­n trá»ng)",
        "risk_help": "TÃ­nh N Ä‘á»ƒ Æ°á»›c lÆ°á»£ng tá»· lá»‡ p vá»›i Ä‘á»™ chÃ­nh xÃ¡c nháº¥t Ä‘á»‹nh. KHÃ”NG Ä‘áº£m báº£o hiá»‡u nÄƒng mÃ´ hÃ¬nh dá»± bÃ¡o.",
        
        # Power Methods (B)
        "title_b3": "B3: Logistic Power (Hsieh)",
        "title_b4": "B4: Cox Power (Schoenfeld)",
        "interpretation": "Giáº£i thÃ­ch káº¿t quáº£",
        
        # Validations (D)
        "title_d8": "D8: AUC Precision (Hanley-McNeil)",
        "d8_desc": "Calculate sample size for estimating AUC with desired precision (CI width).",
        "auc_expected": "AUC dá»± kiáº¿n (C-statistic)",
        "formulas_header": "ğŸ“š CÃ´ng thá»©c & Chi tiáº¿t ká»¹ thuáº­t",
        "d8_assumptions": "**Giáº£ Ä‘á»‹nh**: Sá»­ dá»¥ng xáº¥p xá»‰ phÆ°Æ¡ng sai Hanley & McNeil (1982). Giáº£ Ä‘á»‹nh phÃ¢n phá»‘i chuáº©n Ä‘á»‘i xá»©ng cho AUC. Tá»‘i Æ°u hÃ³a sá»‘ há»c Ä‘á»ƒ tÃ¬m N.",
        "d8_mode_n_to_width": "TÃ­nh Ä‘á»™ rá»™ng CI tá»« N",
        "d8_mode_width_to_n": "TÃ­nh N tá»« Ä‘á»™ rá»™ng CI",
        "d8_opt_settings": "CÃ i Ä‘áº·t Tá»‘i Æ°u hÃ³a NÃ¢ng cao",
        "d8_practical_rounding": "Hiá»ƒn thá»‹ lÃ m trÃ²n sá»‘ nguyÃªn (Thá»±c táº¿)",
        "d8_n_input": "Cá»¡ máº«u (N)",
        "d8_width_input": "Äá»™ rá»™ng CI (Tá»•ng)",
        "d8_opt_bound": "Cáº­n trÃªn tÃ¬m kiáº¿m (Upper Limit)",
        "d8_opt_tol": "Dung sai (Tolerance)",
        
        # D9
        "title_d9": "D9: Tháº©m Ä‘á»‹nh ngoÃ i (Tailored)",
        "common_inputs": "Tham sá»‘ chung",
        
        # UI Basics
        "intro_heading": "ChÃ o má»«ng Ä‘áº¿n vá»›i Prognostic Research Sample Size Tool",
        "search_placeholder": "TÃ¬m phÆ°Æ¡ng phÃ¡p...",
        "settings": "CÃ i Ä‘áº·t",

        # Footer
        "footer_copyright": "Â© 2026 Prognostic Research Sample Size Tool. DÃ nh cho nghiÃªn cá»©u/há»c thuáº­t. KhÃ´ng bÃ¡n thÆ°Æ¡ng máº¡i.",
        "footer_author": "TÃ¡c giáº£ & Báº£o trÃ¬: Minh Nguyen (minhnt@ump.edu.vn)",
        "footer_disclaimer": "Miá»…n trá»« trÃ¡ch nhiá»‡m: KhÃ´ng Ä‘áº£m báº£o tÃ­nh á»©ng dá»¥ng lÃ¢m sÃ ng; ngÆ°á»i dÃ¹ng tá»± chá»‹u trÃ¡ch nhiá»‡m kiá»ƒm Ä‘á»‹nh.",

        "intro_complete_md": """
### ChÃ o má»«ng

á»¨ng dá»¥ng nÃ y giÃºp cÃ¡c nhÃ  lÃ¢m sÃ ng vÃ  nhÃ  nghiÃªn cá»©u tÃ­nh toÃ¡n cá»¡ máº«u tá»‘i thiá»ƒu cho nghiÃªn cá»©u tiÃªn lÆ°á»£ng, bao gá»“m:
* NghiÃªn cá»©u yáº¿u tá»‘ tiÃªn lÆ°á»£ng (power Ä‘á»ƒ phÃ¡t hiá»‡n liÃªn quan),
* XÃ¢y dá»±ng mÃ´ hÃ¬nh dá»± bÃ¡o lÃ¢m sÃ ng (prediction model development), vÃ 
* Tháº©m Ä‘á»‹nh/ngoáº¡i kiá»ƒm & cáº­p nháº­t mÃ´ hÃ¬nh (validation/updating).

á»¨ng dá»¥ng phÃ¹ há»£p cho káº¿t cá»¥c nhá»‹ phÃ¢n (cÃ³/khÃ´ng biáº¿n cá»‘) vÃ  má»™t sá»‘ mÃ´-Ä‘un cho káº¿t cá»¥c thá»i gian sá»‘ng (Cox PH).

MÃ£ nguá»“n (táº£i vá»): [https://gitlab.com/minhthiennguyen/pmsample/](https://gitlab.com/minhthiennguyen/pmsample/)
hoáº·c [https://github.com/nguyenminh2301/pmsample.git](https://github.com/nguyenminh2301/pmsample.git)

### HÆ°á»›ng dáº«n nhanh cho ngÆ°á»i má»›i

#### 1. XÃ¡c Ä‘á»‹nh má»¥c tiÃªu nghiÃªn cá»©u
* Báº¡n muá»‘n kiá»ƒm Ä‘á»‹nh má»™t yáº¿u tá»‘ tiÃªn lÆ°á»£ng (liÃªn quan OR/HR)?
* Báº¡n muá»‘n xÃ¢y dá»±ng mÃ´ hÃ¬nh dá»± bÃ¡o?
* Báº¡n muá»‘n ngoáº¡i kiá»ƒm mÃ´ hÃ¬nh cÃ³ sáºµn á»Ÿ quáº§n thá»ƒ má»›i?

#### 2. Æ¯á»›c tÃ­nh tá»· lá»‡ biáº¿n cá»‘ $p$ (hoáº·c tá»· lá»‡ biáº¿n cá»‘ tÃ­ch lÅ©y cho sá»‘ng cÃ²n)
* Æ¯u tiÃªn láº¥y tá»« dá»¯ liá»‡u bá»‡nh viá»‡n (best).
* Náº¿u chÆ°a cháº¯c, nháº­p khoáº£ng giÃ¡ trá»‹ vÃ  cháº¡y Ä‘á»™ nháº¡y.

#### 3. Äáº¿m Ä‘Ãºng Ä‘á»™ phá»©c táº¡p mÃ´ hÃ¬nh (tham sá»‘/df)
Cáº§n dÃ¹ng sá»‘ tham sá»‘ (df), khÃ´ng chá»‰ "sá»‘ biáº¿n". Quy táº¯c cÆ¡ báº£n:
* Biáº¿n nhá»‹ phÃ¢n: 1 df
* Biáº¿n phÃ¢n loáº¡i $L$ má»©c: $L-1$ df
* Spline RCS $K$ nÃºt: $K-1$ df
* TÆ°Æ¡ng tÃ¡c: $df(A \\times B) = df(A) \\cdot df(B)$

#### 4. Chá»n phÆ°Æ¡ng phÃ¡p phÃ¹ há»£p
* **"Quick tools"** chá»‰ Ä‘á»ƒ kiá»ƒm tra sÆ¡ bá»™.
* Náº¿u xÃ¢y dá»±ng mÃ´ hÃ¬nh dá»± bÃ¡o: Æ°u tiÃªn **Riley / mÃ´ phá»ng / assurance**.

---

### Khi nÃ o nÃªn dÃ¹ng (vÃ  khi nÃ o khÃ´ng nÃªn dÃ¹ng)

**NÃªn dÃ¹ng khi:**
* Láº­p káº¿ hoáº¡ch Ä‘oÃ n há»‡ há»“i cá»©u/tiáº¿n cá»©u trong tiÃªn lÆ°á»£ng/dá»± bÃ¡o
* XÃ¢y dá»±ng/ngoáº¡i kiá»ƒm mÃ´ hÃ¬nh dá»± bÃ¡o nguy cÆ¡
* Cáº§n Æ°á»›c tÃ­nh cá»¡ máº«u theo Ä‘á»™ chÃ­nh xÃ¡c (Ä‘á»™ rá»™ng KTC) cho tá»· lá»‡ hoáº·c AUC
* Thiáº¿t káº¿ ngoáº¡i kiá»ƒm vá»›i má»¥c tiÃªu calibration + discrimination

**KhÃ´ng nÃªn dÃ¹ng nhÆ° cÃ´ng cá»¥ chÃ­nh khi:**
* Thiáº¿t káº¿ thá»­ nghiá»‡m ngáº«u nhiÃªn (RCT) (cáº§n phÆ°Æ¡ng phÃ¡p cá»¡ máº«u riÃªng cho RCT)
* NghiÃªn cá»©u Ä‘á»™ chÃ­nh xÃ¡c cháº©n Ä‘oÃ¡n (Se/Sp) khÃ´ng gáº¯n vá»›i mÃ´ hÃ¬nh dá»± bÃ¡o
* Mong muá»‘n "má»™t con sá»‘ Ä‘Ãºng tuyá»‡t Ä‘á»‘i": cá»¡ máº«u phá»¥ thuá»™c giáº£ Ä‘á»‹nh vÃ  cáº§n phÃ¢n tÃ­ch Ä‘á»™ nháº¡y

---

### Danh má»¥c phÆ°Æ¡ng phÃ¡p (tÃ³m táº¯t)

#### A. Quick / Basic (nhanh, xáº¥p xá»‰)

**A1 â€” Quy táº¯c kinh nghiá»‡m (EPV/EPP) (heuristic)**
* **DÃ¹ng khi:** cáº§n kiá»ƒm tra sÆ¡ bá»™ "sá»‘ biáº¿n cá»‘ cÃ³ Ä‘á»§ tÆ°Æ¡ng Ä‘á»‘i khÃ´ng" theo Ä‘á»™ phá»©c táº¡p mÃ´ hÃ¬nh.
* **KhÃ´ng dÃ¹ng khi:** cÃ³ spline/tÆ°Æ¡ng tÃ¡c/chá»n biáº¿n/biáº¿n cá»‘ hiáº¿mâ€”EPV/EPP khÃ´ng Ä‘áº£m báº£o calibration hoáº·c Ã­t optimism.
* **Äáº§u vÃ o:** tá»· lá»‡ biáº¿n cá»‘ $p$, sá»‘ tham sá»‘ $P$ (df), EPP má»¥c tiÃªu (10/15/20)
* **Äáº§u ra:** $E=t \\cdot P$, $N=\\lceil E/p \\rceil$
* **Máº¡nh:** ráº¥t Ä‘Æ¡n giáº£n, nhanh
* **Yáº¿u:** dá»… gÃ¢y láº¡c quan, khÃ´ng dá»±a trÃªn hiá»‡u nÄƒng

**A2 â€” Äá»™ chÃ­nh xÃ¡c nguy cÆ¡ ná»n (KTC cho tá»· lá»‡)**
* **DÃ¹ng khi:** má»¥c tiÃªu lÃ  Æ°á»›c tÃ­nh tá»· lá»‡ biáº¿n cá»‘ $p$ vá»›i KTC Ä‘á»§ háº¹p (Â±d).
* **KhÃ´ng dÃ¹ng khi:** muá»‘n Ä‘áº£m báº£o hiá»‡u nÄƒng mÃ´ hÃ¬nh dá»± bÃ¡o.
* **Äáº§u vÃ o:** $p$, phÆ°Æ¡ng phÃ¡p KTC (Wilson khuyáº¿n nghá»‹), má»©c tin cáº­y, ná»­a Ä‘á»™ rá»™ng $d$
* **Äáº§u ra:** $N$ tá»‘i thiá»ƒu Ä‘áº¡t ná»­a Ä‘á»™ rá»™ng KTC $\\le d$
* **Máº¡nh:** minh báº¡ch, trá»±c tiáº¿p theo má»¥c tiÃªu Ä‘á»™ chÃ­nh xÃ¡c
* **Yáº¿u:** chá»‰ cho $p$, khÃ´ng nÃ³i vá» AUC/slope

#### B. Prognostic factor (power) (táº­p trung liÃªn quan, khÃ´ng pháº£i sizing cho mÃ´ hÃ¬nh dá»± bÃ¡o)

**B3 â€” Logistic OR Power (Hsieh)**
* **DÃ¹ng khi:** cáº§n power Ä‘á»ƒ phÃ¡t hiá»‡n OR má»¥c tiÃªu cá»§a má»™t yáº¿u tá»‘ tiÃªn lÆ°á»£ng trong logistic regression.
* **KhÃ´ng dÃ¹ng khi:** má»¥c tiÃªu chÃ­nh lÃ  xÃ¢y dá»±ng mÃ´ hÃ¬nh dá»± bÃ¡o.
* **Äáº§u vÃ o:** $p_0$, OR má»¥c tiÃªu, alpha, power, tá»· lá»‡ phÆ¡i nhiá»…m (náº¿u nhá»‹ phÃ¢n) hoáº·c SD (náº¿u liÃªn tá»¥c), tÃ¹y chá»n $R^2$ vá»›i Ä‘á»“ng biáº¿n
* **Äáº§u ra:** $N$ (vÃ  sá»‘ biáº¿n cá»‘ ká»³ vá»ng)
* **Máº¡nh:** khung power kinh Ä‘iá»ƒn
* **Yáº¿u:** khÃ´ng nháº¯m calibration/discrimination

**B4 â€” Cox HR Power (Schoenfeld)**
* **DÃ¹ng khi:** káº¿t cá»¥c sá»‘ng cÃ²n, cáº§n phÃ¡t hiá»‡n HR má»¥c tiÃªu theo Cox PH.
* **KhÃ´ng dÃ¹ng khi:** khÃ³ Æ°á»›c lÆ°á»£ng tá»· lá»‡ biáº¿n cá»‘ theo dÃµi hoáº·c PH khÃ´ng há»£p lÃ½.
* **Äáº§u vÃ o:** HR, alpha, power, tá»· lá»‡ phÃ¢n bá»• (nhá»‹ phÃ¢n) hoáº·c SD (liÃªn tá»¥c), tá»· lá»‡ biáº¿n cá»‘ ká»³ vá»ng trong thá»i gian theo dÃµi
* **Äáº§u ra:** sá»‘ biáº¿n cá»‘ cáº§n thiáº¿t â†’ suy ra $N$
* **Máº¡nh:** phá»• biáº¿n, trá»±c quan theo sá»‘ biáº¿n cá»‘
* **Yáº¿u:** phá»¥ thuá»™c máº¡nh vÃ o giáº£ Ä‘á»‹nh theo dÃµi/censoring

#### C. Prediction model development (khuyáº¿n nghá»‹ cho xÃ¢y dá»±ng mÃ´ hÃ¬nh dá»± bÃ¡o)

**C5 â€” Riley et al. (phÃ¢n tÃ­ch; pmsampsize-like)**
* **DÃ¹ng khi:** phÃ¡t triá»ƒn mÃ´ hÃ¬nh dá»± bÃ¡o, cáº§n háº¡n cháº¿ overfitting vÃ  báº£o Ä‘áº£m Ä‘á»™ chÃ­nh xÃ¡c.
* **KhÃ´ng dÃ¹ng khi:** khÃ´ng cÃ³ giáº£ Ä‘á»‹nh há»£p lÃ½ vá» $p$ vÃ  hiá»‡u nÄƒng dá»± kiáº¿n (AUC hoáº·c $R^2$); khi Ä‘Ã³ dÃ¹ng Ä‘á»™ nháº¡y/mÃ´ phá»ng.
* **Äáº§u vÃ o:** $p$, $P$ (df), shrinkage má»¥c tiÃªu (vÃ­ dá»¥ 0,90), hiá»‡u nÄƒng dá»± kiáº¿n (AUC hoáº·c Coxâ€“Snell $R^2$)
* **Äáº§u ra:** $N$ tá»‘i thiá»ƒu thá»a cÃ¡c tiÃªu chÃ­ (overfitting + precision)
* **Máº¡nh:** cÃ³ cÆ¡ sá»Ÿ, dá»±a trÃªn hiá»‡u nÄƒng
* **Yáº¿u:** phá»¥ thuá»™c giáº£ Ä‘á»‹nh; cáº§n Ä‘áº¿m df chuáº©n

**C6 â€” Development Simulation (Frequentist; samplesizedev/custom DGM)**
* **DÃ¹ng khi:** muá»‘n mÃ´ phá»ng theo Ä‘Ãºng cÃ¡ch báº¡n dá»± kiáº¿n xÃ¢y dá»±ng mÃ´ hÃ¬nh (phi tuyáº¿n/tÆ°Æ¡ng tÃ¡c).
* **KhÃ´ng dÃ¹ng khi:** khÃ´ng mÃ´ táº£ Ä‘Æ°á»£c DGM há»£p lÃ½ hoáº·c cáº§n káº¿t quáº£ tá»©c thÃ¬.
* **Äáº§u vÃ o:** danh sÃ¡ch $N$, giáº£ Ä‘á»‹nh DGM, tiÃªu chÃ­ hiá»‡u nÄƒng, sá»‘ mÃ´ phá»ng, seed
* **Äáº§u ra:** $N$ nhá» nháº¥t Ä‘áº¡t tiÃªu chÃ­
* **Máº¡nh:** linh hoáº¡t, phÃ¹ há»£p mÃ´ hÃ¬nh phá»©c táº¡p
* **Yáº¿u:** tá»‘n tÃ­nh toÃ¡n, nháº¡y giáº£ Ä‘á»‹nh

**C7 â€” Bayesian Assurance (MCMC)**
* **DÃ¹ng khi:** mÃ´ hÃ¬nh cuá»‘i cÃ¹ng Æ°á»›c lÆ°á»£ng báº±ng Bayes/MCMC vÃ  muá»‘n sizing theo assurance.
* **KhÃ´ng dÃ¹ng khi:** khÃ´ng xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c prior há»£p lÃ½ hoáº·c háº¡n cháº¿ compute.
* **Äáº§u vÃ o:** DGM, prior, $N$, tiÃªu chÃ­ assurance, cÃ i Ä‘áº·t MCMC
* **Äáº§u ra:** $N$ nhá» nháº¥t Ä‘áº¡t assurance
* **Máº¡nh:** nháº¥t quÃ¡n vá»›i Bayes
* **Yáº¿u:** compute cao, cáº§n prior

#### D. Validation / Updating (cho mÃ´ hÃ¬nh cÃ³ sáºµn)

**D8 â€” Äá»™ chÃ­nh xÃ¡c AUC (Hanleyâ€“McNeil / presize)**
* **DÃ¹ng khi:** má»¥c tiÃªu ngoáº¡i kiá»ƒm lÃ  KTC AUC Ä‘á»§ háº¹p.
* **KhÃ´ng dÃ¹ng khi:** calibration lÃ  trá»ng tÃ¢m.
* **Äáº§u vÃ o:** AUC ká»³ vá»ng, $p$ hoáº·c tá»· lá»‡ case-control, má»©c tin cáº­y, Ä‘á»™ rá»™ng KTC má»¥c tiÃªu
* **Äáº§u ra:** $N$ tá»‘i thiá»ƒu cho Ä‘á»™ chÃ­nh xÃ¡c AUC
* **Máº¡nh:** nhanh, dá»… dÃ¹ng
* **Yáº¿u:** chá»‰ AUC, xáº¥p xá»‰

**D9 â€” External Validation (Tailored; pmvalsampsize / sampsizeval)**
* **DÃ¹ng khi:** sizing ngoáº¡i kiá»ƒm theo nhiá»u thÆ°á»›c Ä‘o (calibration + discrimination), thÆ°á»ng cáº§n giáº£ Ä‘á»‹nh phÃ¢n bá»‘ LP.
* **KhÃ´ng dÃ¹ng khi:** khÃ´ng biá»‡n minh Ä‘Æ°á»£c giáº£ Ä‘á»‹nh LP/case-mix.
* **Äáº§u vÃ o:** $p$, AUC ká»³ vá»ng, má»¥c tiÃªu slope/CITL, Ä‘á»™ rá»™ng KTC/SE, giáº£ Ä‘á»‹nh phÃ¢n bá»‘ LP
* **Äáº§u ra:** $N$ khuyáº¿n nghá»‹
* **Máº¡nh:** "tailored", chÃº trá»ng calibration
* **Yáº¿u:** phá»©c táº¡p, phá»¥ thuá»™c giáº£ Ä‘á»‹nh

**D10 â€” External Validation (Simulation; LP-based)**
* **DÃ¹ng khi:** cÃ³ thá»ƒ mÃ´ táº£/Æ°á»›c lÆ°á»£ng phÃ¢n bá»‘ LP á»Ÿ quáº§n thá»ƒ ngoáº¡i kiá»ƒm vÃ  muá»‘n mÃ´ phá»ng Ä‘á»™ chÃ­nh xÃ¡c.
* **KhÃ´ng dÃ¹ng khi:** khÃ´ng Æ°á»›c lÆ°á»£ng Ä‘Æ°á»£c LP distribution.
* **Äáº§u vÃ o:** phÃ¢n bá»‘ LP, tham sá»‘ miscalibration, má»¥c tiÃªu Ä‘á»™ rá»™ng KTC, sá»‘ mÃ´ phá»ng, seed
* **Äáº§u ra:** $N$ tá»‘i thiá»ƒu theo mÃ´ phá»ng
* **Máº¡nh:** linh hoáº¡t
* **Yáº¿u:** tá»‘n compute, nháº¡y giáº£ Ä‘á»‹nh

**D11 â€” Updating / Recalibration (intercept/slope)**
* **DÃ¹ng khi:** cáº§n cáº­p nháº­t intercept/slope khi triá»ƒn khai á»Ÿ bá»‡nh viá»‡n má»›i.
* **KhÃ´ng dÃ¹ng khi:** phÃ¡t triá»ƒn mÃ´ hÃ¬nh má»›i hoÃ n toÃ n.
* **Äáº§u vÃ o:** kiá»ƒu cáº­p nháº­t, $p$, má»¥c tiÃªu Ä‘á»™ chÃ­nh xÃ¡c
* **Äáº§u ra:** $N$ Ä‘á»§ á»•n Ä‘á»‹nh cho cáº­p nháº­t
* **Máº¡nh:** thá»±c dá»¥ng khi triá»ƒn khai
* **Yáº¿u:** phá»¥ thuá»™c case-mix vÃ  transportability

---

#### Disclaimer

No clinical warranty; users are responsible for validation and interpretation. Always document assumptions and run sensitivity analyses.

#### Contact

Author & Maintenance: Minh Nguyen (minhnt@ump.edu.vn)
""",

        "a2_content_md": """
### NguyÃªn táº¯c

Chá»©c nÄƒng nÃ y tÃ­nh **cá»¡ máº«u tá»‘i thiá»ƒu (n)** Ä‘á»ƒ Æ°á»›c tÃ­nh **tá»· lá»‡ biáº¿n cá»‘ / nguy cÆ¡ ná»n** (p) (prevalence) vá»›i **Ä‘á»™ chÃ­nh xÃ¡c mong muá»‘n**, biá»ƒu diá»…n báº±ng **ná»­a Ä‘á»™ rá»™ng khoáº£ng tin cáº­y (KTC)** (margin of error).

á»¨ng dá»¥ng:
* mÃ´ táº£ tá»· lá»‡ biáº¿n cá»‘ trong Ä‘oÃ n há»‡ vá»›i KTC Ä‘á»§ háº¹p,
* láº­p káº¿ hoáº¡ch kháº£ thi vÃ  bÃ¡o cÃ¡o dá»‹ch tá»…,
* há»— trá»£ cÃ¡c phÃ¢n tÃ­ch liÃªn quan calibration.

**Háº¡n cháº¿:** PhÆ°Æ¡ng phÃ¡p nÃ y **khÃ´ng Ä‘áº£m báº£o** hiá»‡u nÄƒng mÃ´ hÃ¬nh dá»± bÃ¡o (AUC, calibration slope, optimism). NÃ³ chá»‰ Ä‘áº£m báº£o Ä‘á»™ chÃ­nh xÃ¡c khi **Æ°á»›c tÃ­nh (p)**.

---

### ChÃº giáº£i cÃ¡c giÃ¡ trá»‹ Ä‘áº§u vÃ o

1. **Tá»· lá»‡ biáº¿n cá»‘** (p)
   Tá»· lá»‡ káº¿t cá»¥c xáº£y ra dá»± kiáº¿n trong quáº§n thá»ƒ nghiÃªn cá»©u (vÃ­ dá»¥ 0,10).
   * Náº¿u chÆ°a rÃµ, nÃªn nháº­p má»™t **khoáº£ng giÃ¡ trá»‹** vÃ  cháº¡y phÃ¢n tÃ­ch Ä‘á»™ nháº¡y.
   * Náº¿u cáº§n â€œbáº£o thá»§â€ cho bÃ i toÃ¡n Æ°á»›c tÃ­nh tá»· lá»‡, dÃ¹ng $p=0.50$ (phÆ°Æ¡ng sai lá»›n nháº¥t).

2. **Ná»­a Ä‘á»™ rá»™ng KTC má»¥c tiÃªu** (d)
   Má»¥c tiÃªu sao cho KTC xáº¥p xá»‰: $p \pm d$
   VÃ­ dá»¥: $d = 0.01, 0.02, 0.03$ tÆ°Æ¡ng á»©ng Â±1%, Â±2%, Â±3%.

3. **Má»©c tin cáº­y** (1-$\\alpha$)
   ThÆ°á»ng dÃ¹ng 0,95 hoáº·c 0,99.

4. **PhÆ°Æ¡ng phÃ¡p tÃ­nh KTC**
* **Wilson score (khuyáº¿n nghá»‹):** Ä‘á»™ bao phá»§ tá»‘t hÆ¡n Wald, nháº¥t lÃ  khi (p) gáº§n 0 hoáº·c 1 hoáº·c cá»¡ máº«u vá»«a/nhá».
* **Wald (xáº¥p xá»‰ chuáº©n):** cÃ´ng thá»©c Ä‘Ã³ng Ä‘Æ¡n giáº£n nhÆ°ng cÃ³ thá»ƒ kÃ©m chÃ­nh xÃ¡c khi (n) nhá» hoáº·c (p) cá»±c trá»‹.
* **Clopperâ€“Pearson (exact):** báº£o thá»§ (KTC thÆ°á»ng rá»™ng hÆ¡n â†’ cáº§n (n) lá»›n hÆ¡n).

---

### CÃ¡ch tÃ­nh (cÃ´ng thá»©c vÃ  Ã½ tÆ°á»Ÿng)

Giáº£ sá»­ $X \sim \\text{Binomial}(n,p)$, $\hat p = X/n$. Má»¥c tiÃªu lÃ  tÃ¬m (n) nhá» nháº¥t sao cho:
$$ \\frac{\\text{Upper}(n) - \\text{Lower}(n)}{2} \le d $$

#### A) Wald (xáº¥p xá»‰)
$$ n \\approx \\frac{z^2 p(1-p)}{d^2} $$

#### B) Wilson score (khuyáº¿n nghá»‹)
Sá»­ dá»¥ng cÃ´ng thá»©c khoáº£ng tin cáº­y Wilson.

#### C) Clopperâ€“Pearson (exact)
DÃ¹ng phÃ¢n vá»‹ Beta. ÄÃ¢y lÃ  phÆ°Æ¡ng phÃ¡p báº£o thá»§.

---

### NÃªn chá»n giÃ¡ trá»‹ bao nhiÃªu theo thÃ´ng lá»‡?

* **Má»©c tin cáº­y:** 95% lÃ  chuáº©n.
* **Ná»­a Ä‘á»™ rá»™ng (d):** Â±0,01 Ä‘áº¿n Â±0,03 (1%â€“3%) lÃ  má»©c hay gáº·p.
* **PhÆ°Æ¡ng phÃ¡p:** Wilson lÃ  lá»±a chá»n máº·c Ä‘á»‹nh há»£p lÃ½.

### TÃ i liá»‡u tham kháº£o quan trá»ng
1. **Wilson EB.** Probable inference... *JASA.* 1927.
2. **Newcombe RG.** Two-sided confidence intervals... *Stat Med.* 1998.
""",

        "b3_content_md": """
### Má»¥c Ä‘Ã­ch (phÆ°Æ¡ng phÃ¡p nÃ y lÃ  gÃ¬)

Chá»©c nÄƒng nÃ y Æ°á»›c tÃ­nh **cá»¡ máº«u tá»‘i thiá»ƒu** Ä‘á»ƒ phÃ¡t hiá»‡n má»‘i liÃªn quan giá»¯a biáº¿n dá»± bÃ¡o (X) vÃ  **káº¿t cá»¥c nhá»‹ phÃ¢n** (Y) báº±ng **há»“i quy logistic**, vá»›i **OR má»¥c tiÃªu**, **($\\alpha$) hai phÃ­a**, vÃ  **power** Ä‘Ã£ chá»n.

ÄÃ¢y lÃ  phÆ°Æ¡ng phÃ¡p **power cho nghiÃªn cá»©u yáº¿u tá»‘ tiÃªn lÆ°á»£ng / kiá»ƒm Ä‘á»‹nh liÃªn quan** (kiá»ƒm Ä‘á»‹nh há»‡ sá»‘ há»“i quy), **khÃ´ng pháº£i** phÆ°Æ¡ng phÃ¡p Ä‘áº£m báº£o hiá»‡u nÄƒng cá»§a **mÃ´ hÃ¬nh dá»± bÃ¡o**. NÃ³ **khÃ´ng Ä‘áº£m báº£o** calibration/discrimination cá»§a mÃ´ hÃ¬nh Ä‘a biáº¿n.

---

### Khi nÃ o nÃªn dÃ¹ng

DÃ¹ng B3 khi:

* Báº¡n cáº§n power Ä‘á»ƒ phÃ¡t hiá»‡n **OR cÃ³ Ã½ nghÄ©a lÃ¢m sÃ ng** cho **má»™t biáº¿n** (nhá»‹ phÃ¢n hoáº·c liÃªn tá»¥c) trong logistic regression.
* Má»¥c tiÃªu lÃ  **kiá»ƒm Ä‘á»‹nh giáº£ thuyáº¿t** (biáº¿n cÃ³ liÃªn quan káº¿t cá»¥c hay khÃ´ng), khÃ´ng pháº£i xÃ¢y dá»±ng mÃ´ hÃ¬nh dá»± bÃ¡o nguy cÆ¡.

### Khi nÃ o khÃ´ng nÃªn dÃ¹ng

KhÃ´ng dÃ¹ng B3 lÃ m phÆ°Æ¡ng phÃ¡p chÃ­nh khi:

* Má»¥c tiÃªu lÃ  **xÃ¢y dá»±ng mÃ´ hÃ¬nh dá»± bÃ¡o** (nÃªn dÃ¹ng Riley/pmsampsize hoáº·c mÃ´ phá»ng/assurance).
* Báº¡n dá»± Ä‘á»‹nh **chá»n biáº¿n theo dá»¯ liá»‡u**, dÃ¹ng nhiá»u spline/tÆ°Æ¡ng tÃ¡c, hoáº·c tuning mÃ´ hÃ¬nh phá»©c táº¡p (power cho 1 há»‡ sá»‘ khÃ´ng cÃ²n lÃ  má»¥c tiÃªu phÃ¹ há»£p).
* Dá»¯ liá»‡u cÃ³ **phá»¥ thuá»™c/cá»¥m** (Ä‘a trung tÃ¢m/khoa/phÃ²ng) mÃ  chÆ°a tÃ­nh design effect.
* Thiáº¿t káº¿ **caseâ€“control** vá»›i sá»‘ ca/chá»©ng cá»‘ Ä‘á»‹nh (giÃ¡ trá»‹ ($p_0$) khÃ´ng pháº£n Ã¡nh nguy cÆ¡ ná»n quáº§n thá»ƒ).

---

## MÃ´ hÃ¬nh vÃ  tham sá»‘

MÃ´ hÃ¬nh logistic:
$$
\\text{logit}{P(Y=1\\mid X)}=\\beta_0+\\beta_1 X
$$

* Náº¿u ($X$) nhá»‹ phÃ¢n 0/1:
  $$
  \\mathrm{OR}=\\exp(\\beta_1)
  $$
* Náº¿u ($X$) liÃªn tá»¥c: OR pháº£i gáº¯n vá»›i má»™t má»©c thay Ä‘á»•i cá»§a ($X$) (thÃ´ng dá»¥ng nháº¥t: **tÄƒng 1 SD**).

Kiá»ƒm Ä‘á»‹nh:
$$
H_0:\\beta_1=0 \\quad \\text{vs}\\quad H_1:\\beta_1\\neq 0
$$

---

## ChÃº giáº£i cÃ¡c Ä‘áº§u vÃ o

1. **Alpha (2 phÃ­a)** ($\\alpha$): thÆ°á»ng 0,05; 0,01 náº¿u nghiÃªm ngáº·t hÆ¡n.
2. **Power** ($1-\\beta$): thÆ°á»ng 0,80; 0,90 náº¿u cáº§n tháº­n trá»ng.
3. **Tá»· lá»‡ biáº¿n cá»‘ ná»n** ($p_0$)

   * Vá»›i ($X$) nhá»‹ phÃ¢n: ($p_0=P(Y=1\\mid X=0)$).
   * Vá»›i ($X$) liÃªn tá»¥c: ($p_0$) thÆ°á»ng hiá»ƒu lÃ  tá»· lá»‡ biáº¿n cá»‘ táº¡i **giÃ¡ trá»‹ trung bÃ¬nh** cá»§a ($X$) (sau khi center).
4. **OR má»¥c tiÃªu**: má»©c OR nhá» nháº¥t cÃ³ Ã½ nghÄ©a lÃ¢m sÃ ng.
5. **Loáº¡i biáº¿n dá»± bÃ¡o**

   * Nhá»‹ phÃ¢n: cáº§n ($q=P(X=1)$).
   * LiÃªn tá»¥c: cáº§n OR cho **tÄƒng 1 SD** (hoáº·c pháº£i quy Ä‘á»•i tá»« OR theo 1 Ä‘Æ¡n vá»‹).
6. **($R^2$) vá»›i cÃ¡c Ä‘á»“ng biáº¿n khÃ¡c**

   * ($R^2$) lÃ  má»©c Ä‘á»™ ($X$) Ä‘Æ°á»£c giáº£i thÃ­ch bá»Ÿi cÃ¡c Ä‘á»“ng biáº¿n khÃ¡c (khi há»“i quy ($X$) theo cÃ¡c biáº¿n khÃ¡c).
   * ($R^2$) cÃ ng lá»›n â†’ cáº§n cá»¡ máº«u cÃ ng lá»›n (vÃ¬ thÃ´ng tin â€œÄ‘á»™c láº­pâ€ cá»§a ($X$) giáº£m).

---

# CÃ¡ch tÃ­nh (cÃ´ng thá»©c)

## BÆ°á»›c 1 â€” Quy Ä‘á»•i OR vÃ  ($p_0$) sang ($p_1$) (khi ($X$) nhá»‹ phÃ¢n)

$$
\\text{odds}_0=\\frac{p_0}{1-p_0},\\quad \\text{odds}_1=\\mathrm{OR}\\cdot \\text{odds}_0,\\quad
p_1=\\frac{\\text{odds}_1}{1+\\text{odds}_1}
$$

Tá»· lá»‡ biáº¿n cá»‘ chung:
$$
p=(1-q)p_0+q p_1
$$

## BÆ°á»›c 2 â€” Z-score

$$
z_{\\alpha}=z_{1-\\alpha/2}, \\qquad z_{\\beta}=z_{1-\\beta}=z_{\\text{power}}
$$

## A) Cá»¡ máº«u vá»›i biáº¿n dá»± bÃ¡o nhá»‹ phÃ¢n

$$
n_0=
\\frac{
\\left[
z_{\\alpha}\\sqrt{\\frac{p(1-p)}{q(1-q)}}
+
z_{\\beta}\\sqrt{\\frac{p_1(1-p_1)}{q}+\\frac{p_0(1-p_0)}{1-q}}
\\right]^2
}
{(p_1-p_0)^2}
$$

### Hiá»‡u chá»‰nh khi cÃ³ nhiá»u Ä‘á»“ng biáº¿n (tÆ°Æ¡ng quan vá»›i biáº¿n khÃ¡c)

$$
n=\\frac{n_0}{1-R^2}
$$

### Sá»‘ biáº¿n cá»‘ ká»³ vá»ng

$$
E \\approx n\\cdot p
$$

---

## B) Cá»¡ máº«u vá»›i biáº¿n dá»± bÃ¡o liÃªn tá»¥c

Giáº£ Ä‘á»‹nh OR Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a cho **tÄƒng 1 SD** cá»§a ($X$) (kÃ½ hiá»‡u ($\\mathrm{OR}_{SD}$)), vÃ  ($p_0$) lÃ  tá»· lá»‡ biáº¿n cá»‘ táº¡i trung bÃ¬nh cá»§a ($X$):

$$
n_0=\\frac{(z_{\\alpha}+z_{\\beta})^2}{p_0(1-p_0), [\\log(\\mathrm{OR}_{SD})]^2}
$$

Náº¿u OR nháº­p theo **tÄƒng 1 Ä‘Æ¡n vá»‹** lÃ  ($\\mathrm{OR}_{unit}$), vÃ  SD cá»§a ($X$) lÃ  ($\\sigma_X$), thÃ¬:
$$
\\log(\\mathrm{OR}_{SD})=\\log(\\mathrm{OR}_{unit})\\cdot \\sigma_X
$$

Sau Ä‘Ã³ hiá»‡u chá»‰nh tÆ°Æ¡ng quan Ä‘á»“ng biáº¿n:
$$
n=\\frac{n_0}{1-R^2}
$$

---

## NÃªn chá»n giÃ¡ trá»‹ bao nhiÃªu theo thÃ´ng lá»‡?

* **($\\alpha$)**: 0,05 (hai phÃ­a) lÃ  phá»• biáº¿n; giáº£m ($\\alpha$) náº¿u cÃ³ nhiá»u kiá»ƒm Ä‘á»‹nh.
* **Power**: 0,80 (thÆ°á»ng dÃ¹ng); 0,90 (tháº­n trá»ng hÆ¡n).
* **OR má»¥c tiÃªu**: chá»n OR nhá» nháº¥t cÃ³ Ã½ nghÄ©a lÃ¢m sÃ ng (thÆ°á»ng 1,2â€“2,0 tÃ¹y bá»‘i cáº£nh).
* **($p_0$)**: Æ°u tiÃªn dá»¯ liá»‡u bá»‡nh viá»‡n; náº¿u chÆ°a cÃ³, dÃ¹ng y vÄƒn vÃ  cháº¡y Ä‘á»™ nháº¡y.
* **($q$)**: láº¥y tá»« tá»· lá»‡ phÆ¡i nhiá»…m thá»±c táº¿; ($q$) gáº§n 0,5 thÆ°á»ng cho cá»¡ máº«u nhá» hÆ¡n; ($q$) ráº¥t tháº¥p/cao lÃ m tÄƒng ($n$).
* **($R^2$)**: náº¿u chÆ°a cháº¯c, cháº¡y Ä‘á»™ nháº¡y (0; 0,1; 0,25; 0,5).
* **Biáº¿n liÃªn tá»¥c**: nÃªn chuáº©n hÃ³a ($X$) (mean 0, SD 1) Ä‘á»ƒ OR theo 1 SD dá»… hiá»ƒu.

---

## TÃ i liá»‡u tham kháº£o quan trá»ng (2â€“5)

1. Hsieh FY, Bloch DA, Larsen MD. *A simple method of sample size calculation for linear and logistic regression.* Statistics in Medicine. 1998;17(14):1623â€“1634.
2. Hsieh FY. *Sample size tables for logistic regression.* Statistics in Medicine. 1989;8(7):795â€“802.
3. Whittemore AS. *Sample size for logistic regression with small response probability.* Journal of the American Statistical Association. 1981;76:27â€“32.
""",
        "c5_content_md": """
### PhÆ°Æ¡ng phÃ¡p nÃ y lÃ  gÃ¬?

C5 triá»ƒn khai cÃ¡c **tiÃªu chÃ­ cá»¡ máº«u tá»‘i thiá»ƒu cá»§a Riley vÃ  cá»™ng sá»±** cho **xÃ¢y dá»±ng mÃ´ hÃ¬nh dá»± bÃ¡o Ä‘a biáº¿n** vá»›i **káº¿t cá»¥c nhá»‹ phÃ¢n** (há»“i quy logistic). Má»¥c tiÃªu lÃ  báº£o Ä‘áº£m cá»¡ máº«u Ä‘á»§ Ä‘á»ƒ:

1. **Háº¡n cháº¿ overfitting** (nháº¯m tá»›i há»‡ sá»‘ co rÃºt toÃ n cá»¥c / calibration slope má»¥c tiÃªu),
2. Báº£o Ä‘áº£m **Ä‘á»™ chÃ­nh xÃ¡c** cá»§a hiá»‡u nÄƒng mÃ´ hÃ¬nh (giá»›i háº¡n má»©c â€œláº¡c quanâ€ cá»§a $R^2$), vÃ 
3. Æ¯á»›c tÃ­nh **nguy cÆ¡ ná»n/tá»· lá»‡ biáº¿n cá»‘ chung** (intercept) Ä‘á»§ chÃ­nh xÃ¡c.

ÄÃ¢y lÃ  phÆ°Æ¡ng phÃ¡p cho **phÃ¡t triá»ƒn mÃ´ hÃ¬nh** (khÃ´ng pháº£i ngoáº¡i kiá»ƒm). Äáº·c biá»‡t phÃ¹ há»£p khi báº¡n xÃ¢y dá»±ng mÃ´ hÃ¬nh logistic vá»›i **danh sÃ¡ch biáº¿n vÃ  cÃ¡ch mÃ£ hÃ³a Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh trÆ°á»›c**, vÃ  muá»‘n thay tháº¿ quy táº¯c EPV Ä‘Æ¡n giáº£n báº±ng phÆ°Æ¡ng phÃ¡p cÃ³ cÆ¡ sá»Ÿ hÆ¡n.

---

### Khi nÃ o nÃªn dÃ¹ng

DÃ¹ng C5 khi:

* Báº¡n Ä‘ang **xÃ¢y dá»±ng** mÃ´ hÃ¬nh dá»± bÃ¡o cho **káº¿t cá»¥c nhá»‹ phÃ¢n**.
* Báº¡n cÃ³ thá»ƒ Æ°á»›c lÆ°á»£ng (dÃ¹ gáº§n Ä‘Ãºng) **tá»· lá»‡ biáº¿n cá»‘** vÃ  **hiá»‡u nÄƒng dá»± kiáº¿n** (Coxâ€“Snell $R^2$ hoáº·c AUC).
* Báº¡n muá»‘n nháº¯m tá»›i **Ã­t overfitting** (vÃ­ dá»¥ $S \\ge 0{,}90$) vÃ  Ä‘á»™ chÃ­nh xÃ¡c há»£p lÃ½.

### Khi nÃ o khÃ´ng nÃªn dÃ¹ng (hoáº·c cáº§n tháº­n trá»ng)

KhÃ´ng nÃªn chá»‰ dá»±a vÃ o C5 khi:

* Báº¡n dá»± Ä‘á»‹nh **chá»n biáº¿n theo dá»¯ liá»‡u**, dÃ¹ng nhiá»u tÆ°Æ¡ng tÃ¡c/spline/tinh chá»‰nh phá»©c táº¡p mÃ  chÆ°a quy Ä‘á»•i Ä‘Ãºng **df hiá»‡u dá»¥ng**.
* Dá»¯ liá»‡u cÃ³ **cá»¥m/Ä‘a trung tÃ¢m** mÃ  chÆ°a tÃ­nh design effect.
* PhÆ°Æ¡ng phÃ¡p mÃ´ hÃ¬nh hÃ³a khÃ¡c xa logistic chuáº©n (ML phá»©c táº¡p) mÃ  khÃ´ng cÃ³ cÃ¡ch quy Ä‘á»•i Ä‘á»™ phá»©c táº¡p sang **df hiá»‡u dá»¥ng**; khi Ä‘Ã³ nÃªn cÃ¢n nháº¯c mÃ´ phá»ng.
* Báº¡n khÃ´ng thá»ƒ biá»‡n minh báº¥t ká»³ giáº£ Ä‘á»‹nh nÃ o vá» AUC/$R^2$; khi Ä‘Ã³ nÃªn cháº¡y Ä‘á»™ nháº¡y rá»™ng vÃ /hoáº·c dÃ¹ng mÃ´ phá»ng.

---

## ChÃº giáº£i cÃ¡c Ä‘áº§u vÃ o

1. **Tá»· lá»‡ biáº¿n cá»‘** (p)
   Tá»· lá»‡ (Y=1) dá»± kiáº¿n trong bá»™ dá»¯ liá»‡u phÃ¡t triá»ƒn mÃ´ hÃ¬nh.

2. **Sá»‘ tham sá»‘ mÃ´ hÃ¬nh (df)** (P)
   Tá»•ng báº­c tá»± do cá»§a táº¥t cáº£ biáº¿n dá»± bÃ¡o **khÃ´ng tÃ­nh intercept**.
   Bao gá»“m: dummy cá»§a biáº¿n phÃ¢n loáº¡i, basis spline, tÆ°Æ¡ng tÃ¡c, vÃ  má»i biáº¿n Ä‘á»•i táº¡o thÃªm há»‡ sá»‘.

3. **Hiá»‡u nÄƒng dá»± kiáº¿n** (chá»n má»™t)

* **Coxâ€“Snell ($R^2_{CS}$)**: Æ°u tiÃªn náº¿u cÃ³ tá»« nghiÃªn cá»©u liÃªn quan (lÃ½ tÆ°á»Ÿng lÃ  Ä‘Ã£ hiá»‡u chá»‰nh láº¡c quan).
* **AUC (C-statistic)**: náº¿u khÃ´ng cÃ³ $R^2_{CS}$, cÃ³ thá»ƒ xáº¥p xá»‰ $R^2_{CS}$ tá»« AUC vÃ  ($p$) theo phÆ°Æ¡ng phÃ¡p Ä‘Ã£ cÃ´ng bá»‘.
* **Báº£o thá»§ (15% cá»§a $R^2$ tá»‘i Ä‘a)**: dÃ¹ng khi khÃ´ng cÃ³ AUC/$R^2$; chá»‰ nÃªn dÃ¹ng cho Æ°á»›c tÃ­nh sÆ¡ bá»™ vÃ  luÃ´n cháº¡y phÃ¢n tÃ­ch Ä‘á»™ nháº¡y.

4. **Má»¥c tiÃªu shrinkage toÃ n cá»¥c** (S)
   ThÆ°á»›c Ä‘o kiá»ƒm soÃ¡t overfitting (thÆ°á»ng diá»…n giáº£i gáº§n vá»›i calibration slope ká»³ vá»ng sau ná»™i kiá»ƒm).

* Máº·c Ä‘á»‹nh hay dÃ¹ng: $S=0{,}90$ (tÆ°Æ¡ng Ä‘Æ°Æ¡ng cáº§n shrink ~10%).
* Báº£o thá»§ hÆ¡n: $S=0{,}95$.

---

## KhÃ¡i niá»‡m vÃ  cÃ´ng thá»©c

### Coxâ€“Snell ($R^2$) vÃ  giÃ¡ trá»‹ tá»‘i Ä‘a

$$
R^2_{CS} = 1-\\exp\\left(\\frac{2}{n}(\\ell_0-\\ell_1)\\right),
$$
trong Ä‘Ã³ $\\ell_0$ lÃ  log-likelihood mÃ´ hÃ¬nh chá»‰ cÃ³ intercept vÃ  $\\ell_1$ lÃ  log-likelihood mÃ´ hÃ¬nh Ä‘áº§y Ä‘á»§.

Vá»›i káº¿t cá»¥c nhá»‹ phÃ¢n, $R^2_{CS}$ khÃ´ng Ä‘áº¡t 1. GiÃ¡ trá»‹ tá»‘i Ä‘a phá»¥ thuá»™c ($p$):
$$
\\ell_0 = n\\Big[p\\ln(p) + (1-p)\\ln(1-p)\\Big],
$$
$$
R^2_{CS,\\max}=1-\\exp\\left(\\frac{2\\ell_0}{n}\\right)
=1-\\exp\\Big(2[p\\ln(p) + (1-p)\\ln(1-p)]\\Big).
$$

Nagelkerke ($R^2$):
$$
R^2_{Nag}=\\frac{R^2_{CS}}{R^2_{CS,\\max}}.
$$

---

## Ba tiÃªu chÃ­ Riley (káº¿t cá»¥c nhá»‹ phÃ¢n)

### TiÃªu chÃ­ 1 â€” Giá»›i háº¡n overfitting báº±ng shrinkage má»¥c tiÃªu (S)

$$
n_1=\\left\\lceil
\\frac{P}{(S-1)\\ln\\left(1-\\frac{R^2_{CS}}{S}\\right)}
\\right\\rceil.
$$

### TiÃªu chÃ­ 2 â€” Giá»›i háº¡n má»©c láº¡c quan cá»§a ($R^2$) (máº·c Ä‘á»‹nh 0,05)

TiÃªu chÃ­ nÃ y nháº¯m tá»›i chÃªnh lá»‡ch tuyá»‡t Ä‘á»‘i (máº·c Ä‘á»‹nh $\\delta=0{,}05$) giá»¯a ($R^2$) biá»ƒu kiáº¿n vÃ  ($R^2$) hiá»‡u chá»‰nh trÃªn thang **Nagelkerke**. Shrinkage tÆ°Æ¡ng á»©ng:
$$
S_{\\delta}=\\frac{R^2_{CS}}{R^2_{CS}+\\delta R^2_{CS,\\max}}.
$$
Sau Ä‘Ã³:
$$
n_2=\\left\\lceil
\\frac{P}{(S_{\\delta}-1)\\ln\\left(1-\\frac{R^2_{CS}}{S_{\\delta}}\\right)}
\\right\\rceil.
$$

### TiÃªu chÃ­ 3 â€” Æ¯á»›c tÃ­nh chÃ­nh xÃ¡c nguy cÆ¡ ná»n (intercept)

Nháº¯m tá»›i Æ°á»›c tÃ­nh ($p$) trong khoáº£ng ($\\pm d$) (máº·c Ä‘á»‹nh $d=0{,}05$ á»Ÿ má»©c 95%):
$$
n_3=\\left\\lceil
\\left(\\frac{z_{1-\\alpha/2}}{d}\\right)^2 p(1-p)
\\right\\rceil,
\\quad \\text{máº·c Ä‘á»‹nh } z_{0.975}=1.96,; d=0.05.
$$

### Káº¿t quáº£ cuá»‘i cÃ¹ng

$$
n_{\\min}=\\max(n_1,n_2,n_3),\\qquad
E = n_{\\min}p,\\qquad
EPP=\\frac{E}{P}.
$$

---

## Gá»£i Ã½ chá»n giÃ¡ trá»‹ theo thÃ´ng lá»‡

* **Shrinkage (S)**: thÆ°á»ng chá»n **0,90**; cÃ¢n nháº¯c **0,95** náº¿u mÃ´ hÃ¬nh phá»©c táº¡p hoáº·c muá»‘n giáº£m overfitting máº¡nh hÆ¡n.
* **$\\delta=0{,}05$** (TiÃªu chÃ­ 2): thÆ°á»ng giá»¯ máº·c Ä‘á»‹nh.
* **Äá»™ chÃ­nh xÃ¡c intercept (d=0{,}05)**: máº·c Ä‘á»‹nh tÆ°Æ¡ng á»©ng Æ°á»›c tÃ­nh nguy cÆ¡ ná»n trong Â±5%. Náº¿u cáº§n chÃ­nh xÃ¡c hÆ¡n (d nhá» hÆ¡n) thÃ¬ cáº§n (n) lá»›n hÆ¡n.
* **$R^2_{CS}$ dá»± kiáº¿n**:

  * Æ¯u tiÃªn giÃ¡ trá»‹ **Ä‘Ã£ hiá»‡u chá»‰nh láº¡c quan** tá»« nghiÃªn cá»©u phÃ¡t triá»ƒn tÆ°Æ¡ng tá»±, hoáº·c giÃ¡ trá»‹ biá»ƒu kiáº¿n tá»« ngoáº¡i kiá»ƒm.
  * Náº¿u chá»‰ cÃ³ AUC, dÃ¹ng phÆ°Æ¡ng phÃ¡p xáº¥p xá»‰ AUCâ†’$R^2_{CS}$ theo bÃ i bÃ¡o hÆ°á»›ng dáº«n.
  * Náº¿u khÃ´ng cÃ³ AUC/$R^2$, tÃ¹y chá»n **15% cá»§a $R^2_{CS,\\max}$** chá»‰ nÃªn dÃ¹ng Ä‘á»ƒ Æ°á»›c tÃ­nh sÆ¡ bá»™ vÃ  luÃ´n cháº¡y phÃ¢n tÃ­ch Ä‘á»™ nháº¡y.

---

## TÃ i liá»‡u tham kháº£o quan trá»ng (2â€“5)

1. Riley RD, Snell KIE, Ensor J, et al. *Minimum sample size required for developing a multivariable prediction model: PART IIâ€”binary and time-to-event outcomes.* Statistics in Medicine. 2019.
2. Riley RD, Ensor J, Snell KIE, et al. *Calculating the sample size required for developing a clinical prediction model.* BMJ. 2020.
3. Riley RD, Van Calster B, Collins GS. *A note on estimating the Coxâ€“Snell ($R^2$) from a reported C statistic (AUROC) to inform sample size calculations for developing a prediction model with a binary outcome.* Statistics in Medicine. 2021.
4. Harrell FE Jr, Lee KL, Mark DB. *Multivariable prognostic models: issues in developing models, evaluating assumptions and adequacy, and measuring and reducing errors.* Statistics in Medicine. 1996.
""",
}
