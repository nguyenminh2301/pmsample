# 예후 연구를 위한 최소 표본 크기 추정 (Minimum Sample Size Estimation for Prognostic Research)

[![Streamlit App](https://static.streamlit.io/badges/streamlit_badge_black_white.svg)](https://pmsample.streamlit.app/)
[![Python 3.9+](https://img.shields.io/badge/python-3.9%2B-blue.svg)](https://www.python.org/downloads/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

임상 예후 연구의 최소 표본 크기를 계산하기 위해 설계된 엄격하고 전문적인 툴킷입니다. 데이터 과학자, 통계학자 및 임상 연구자를 위해 개발된 이 애플리케이션은 **예측 모델 개발**, **외부 검증**, **예후 요인 연구** 및 **모델 업데이트**를 위한 검증된 통계적 방법을 구현합니다.

🔗 **라이브 애플리케이션:** [https://pmsample.streamlit.app/](https://pmsample.streamlit.app/)

---

## 1. 개요 및 목적

본 애플리케이션은 의학 연구에서 표본 크기 계획의 복잡한 요구 사항을 해결하기 위한 포괄적인 도구 모음을 제공합니다. 기본 검정력 계산기와 달리, 이 도구는 단순한 가설 검정보다는 위험(교정 및 판별)의 정확한 추정이 목표인 *예후 모델링*의 구체적인 뉘앙스에 초점을 맞춥니다.

### 주요 기능
*   **방법론적 엄격성**: 동료 심사를 거친 통계 문헌(Riley et al., Hanley & McNeil, Hsieh, et al.)을 엄격히 준수하는 알고리즘을 구현합니다.
*   **검증(Validation)**: 핵심 계산은 정확성을 보장하기 위해 확립된 R 패키지(`pmsampsize`, `presize`, `pmvalsampsize`, `sampsizeval`)와 대조하여 검증되었습니다.
*   **이중 언어 지원**: 영어와 베트남어를 완벽하게 지원하며 한국어를 부분 지원하여 국제적인 협력을 촉진합니다.
*   **민감도 분석**: 통합 배치 처리를 통해 연구자는 다양한 가정(예: 유병률 또는 예상 $R^2$의 변화)에 따라 표본 크기 요구 사항이 어떻게 달라지는지 평가할 수 있습니다.

---

## 2. 방법론 카탈로그

애플리케이션은 연구 수명 주기의 특정 단계를 대상으로 하는 4개의 주요 모듈로 구성됩니다.

### A. 예비 타당성 평가
| 방법 | 설명 | 적용 시나리오 |
| :--- | :--- | :--- |
| **A1: 변수 당 이벤트 (EPV/EPP)** | 후보 예측 변수 파라미터에 대한 이벤트의 비율을 기반으로 한 경험적 접근 방식입니다. | *타당성 확인용.* 과적합이나 교정을 설명할 수 없으므로 연구 계획서의 **주요 근거로 권장되지 않습니다.** |
| **A2: 기본 위험의 정밀도** | 지정된 신뢰 구간(CI) 반폭으로 결과 유병률을 추정하는 데 필요한 표본 크기를 추정합니다. | 기술 역학; 대규모 교정(calibration-in-the-large) 계획. |

### B. 예후 요인 연구 (연관성)
| 방법 | 설명 | 참고 문헌 |
| :--- | :--- | :--- |
| **B3: 로지스틱 회귀 검정력** | 다른 요인과의 공분산을 조정하여, 특정 예측 변수에 대한 목표 오즈비(OR)를 탐지하기 위한 표본 크기를 계산합니다. | **Hsieh et al. (1998)** |
| **B4: Cox 회귀 검정력** | 생존 분석에서 목표 위험비(HR)를 탐지하는 데 필요한 이벤트 수를 계산합니다. | **Schoenfeld (1983)** |

### C. 예측 모델 개발 (권장)
새로운 임상 예측 모델을 개발하기 위한 핵심 모듈입니다.

| 방법 | 설명 | 주요 목표 |
| :--- | :--- | :--- |
| **C5: 분석적 접근 (Riley)** | **골드 스탠다드.** 다변량 모델 개발을 위한 폐쇄형 솔루션입니다. | 1. 글로벌 수축 제한 ($S \ge 0.9$).<br>2. 겉보기 성능의 낙관주의 제한.<br>3. 절편의 정밀한 추정. |
| **C6: 시뮬레이션 기반 설계** | 복잡한 모델에 대한 요구 사항을 추정하기 위해 특정 데이터 생성 메커니즘(DGM)을 시뮬레이션합니다. | 비선형 항, 복잡한 상호 작용, 특정 상관 구조. |
| **C7: 베이지안 보증 (Bayesian Assurance)** | MCMC 기반 시뮬레이션을 통해 성공 확률(보증)이 보장된 표본 크기를 결정합니다. | 베이지안 모델 개발. |

### D. 검증 및 업데이트
기존 모델의 외부 검증을 계획하기 위한 도구입니다.

| 방법 | 설명 | 참고 문헌 |
| :--- | :--- | :--- |
| **D8: AUC 정밀도** | AUC(C-통계량)에 대한 특정 신뢰 구간 너비를 달성하기 위한 N을 계산합니다. | **Hanley & McNeil (1982)** |
| **D9: 맞춤형 검증 크기 조정** | O/E 비율, 교정 기울기 및 AUC의 정밀한 추정을 보장하기 위해 N을 계산합니다. | **Riley et al. (2021)** / `pmvalsampsize` |
| **D10: 검증 시뮬레이션** | 선형 예측자(LP)의 분포를 사용한 시뮬레이션 기반 계획. | **Snell et al. (2021)** |
| **D11: 모델 업데이트** | 새로운 환경을 위해 기존 모델(절편/기울기)을 업데이트(재교정)하는 데 필요한 표본 크기. | **Van Calster et al.** |

---

## 3. 설치 및 로컬 실행

자신의 인프라 내에 이 애플리케이션을 배포하려면:

### 전제 조건
*   Python 3.9 이상
*   Git

### 배포 단계

1.  **저장소 복제**
    ```bash
    git clone https://github.com/nguyenminh2301/pmsample.git
    cd pmsample
    ```

2.  **환경 설정**
    가상 환경(virtual environment)을 사용하는 것이 좋습니다.
    ```bash
    python -m venv .venv
    # Windows:
    .venv\Scripts\activate
    # macOS/Linux:
    source .venv/bin/activate
    ```

3.  **의존성 설치**
    ```bash
    pip install -r requirements.txt
    ```

4.  **애플리케이션 실행**
    ```bash
    streamlit run pmsampsize_app/app.py
    ```

---

## 4. 면책 조항 및 책임

**학술 및 연구 목적으로만 사용하십시오.**

이 소프트웨어는 동료 심사를 거친 문헌에 발표된 통계적 방법을 구현한 것입니다. 알고리즘의 정확성을 보장하기 위해 모든 노력을 기울였으나, 저자 및 유지 관리자는 이 도구를 기반으로 한 연구의 설계 또는 결과에 대해 어떠한 책임도 지지 않습니다.

*   **사용자 책임**: 사용자는 입력 매개변수를 확인하고 특정 임상 영역의 맥락 내에서 결과를 해석할 책임이 있습니다.
*   **임상적 보증 없음**: 이 도구는 의학적 조언을 제공하지 않습니다.

---

**저자 및 유지 관리:**
Minh Nguyen (minhnt@ump.edu.vn)
